---
title: "Limits to Spontaneous Resets in the Double-Drift Illusion"
output: html_notebook
---

# Overview

State aims of the project. Say which experiments were done and are analyzed here.

# Setting up

Before starting any analyses, we need to make sure that we have all the code and data necessary, this will be set up by the chunks below

## Libraries

We've minimized depencies on other packages, but there are two that help - even when not strictly required.

```{r}
library('svglite')
library('ez')

# these packages are not mandatory
# - svglite generates SVG versions of the figures, but the native R figures might be enough
# - ez allows one ANOVA to be run, but this part could be skipped

# if you do want to install them, use this:
# install.packages(c('svglite','ez'))
# they seem to rely on other packages: 'data.table', 'ggplot2', 'dplyr', 'lme4', and 'car'

```

## Functions

There are several files with code that will do the work for us in pre-processing, plotting and doing stats.

```{r}
# The functions here allow downloading the collected data from the OSF project:
source('R/data.R')
# This file has some common helper functions:

# The functions in here are used on the data of the first tracking experiment:
source('R/tracking_bounded.R')
# This code is for the second tracking experiment:
source('R/tracking_reset_pause.R')
# And finally some code for the re-tracin experiment...
source('R/retrace_onePass_V4.R')
# As well as models fit to that data:
source('R/models.R')
```

## Download data

A last step before starting actual analyses is to download the data from the Open Science Framework:

```{r}
# from R/data.R
downloadRawData(overwrite=FALSE, experiments=c('bounded_tracking', 'reset_pause', 'onePass_V4'))
```

If there were no errors, we're now ready to start.

# Experiment 1a: continuous tracking

In this experiment, 6 participants were instructed to look at a fixation point at the left or right side of the screen, while moving a tablet controlled cursor to the center of the screen. Subsequently, a double-drift stimulus would appear and then move on a straight, 13.5 cm path along the Y axis of the screen (not sideways, but forward/backward, or upward/downward if you like), starting in one of two directions at random. When the double-drift stimulus would reach either end of the path, both it's external and internal motion would be inverted. This way it would appear to move on a diagonal, with the angle of the diagonal depending on the direction and velocity of the internal motion. Participants were to use the stylus on the tablet to track the perceived position of the stimulus while it was moving. The stimulus would complete 3 full cycles (if one path is the 13.5 cm: a half path, five full paths, and another half path) in 12 seconds. That is: a single path takes 2 seconds. The internal motion could have one of 5 values -3, -1, 0, 1 or 3 cycles per second (the number of complete phases the gabor would cycle through in 1 second). Each of these 5 internal motion values was repeated 8 times (with random initial direction and fixation side) for a total of 40 trials.

Here we plot the trajectories recorded during this task (each subplot essentially shows 8 trials overlayed):

```{r fig.width=7, fig.height=6}
# from R/tracking_bounded.R:
plotBoundedTrackingRaw()
```

We can see that the orientation of the tracking movements responds to the strength and direction of the internal motion of the stimulus. However, there are no clear spontaneous resets of the stimulus.

The MEAN would say: "the majority of trials / participants show no evidence of a reset".

I'd like to be able to say: "there is no evidence of any resets in all of the data". That is hard to do, unless I find a way to do an appropriate equivalence test (where the key problem is in the word 'appropriate').

But I would settle for: "the majority of data shows no resets, and there's no easily identifiable minority in the data with resets either".

And we can do the latter if we find a measure that would be somewhat bimodal in case of a few resets. A search reveals that one of the most accepted tests is recently Hartigan's Dip Test for unimodality (H1: not unimodal), at least a few years ago, so this might have changed, but it should still work. It is in the package 'diptest'.

# Experiment 1b: continuous tracking with pauses

Therefore, we did another experiment that mimicked the first, but with three changes, all designed to increase the occurrence of resets. First, the external motion was halved as earlier work showed that resets often occur after around 2-4 seconds [@Lisi2015 ??], and 2 seconds was how long one pass (from one end of the screen to the other) took in the first experiment. So now, the double-drift stimulus would do a single pass in 4 seconds instead of 2 seconds. Second, we only used -3 and 3 cycles per second for the internal motion as this would increase the strength of the illusion and perhaps lead to a higher chance of reset. Third, on 2 of every 4 trials, a ~266.66 ms "blink" (8 frames at 30 Hz) was introduced in the stimulus. During this period the stimulus disappeared from the screen and reappeared after the blink in the same location to continue as before. The blinks occured either in the first or second full pass of the stimulus, halfway along the path on screen. These blinks have been shown to trigger resets [@Lisis201X; @Nakayama2018], so if we can spot triggered resets in the tracking data, we can use the characteristics of that tracking data to detect spontaneous resets. However, we would primarily expect to see increases in horizontal tracking speed, perhaps accompanied by a decrease in vertical speed, when people track the "jump" in the perceived location of the stimulus.

Here is a plot of trajectories just before (orange), during (red) as well as for 1500 ms after a pause (purple). The trajectories are normalized for the different directions (trajectories always shown going up and to the right, but could have been down and/or to the left) and the trajectories are all shown relative to the start of the pause, which is where they cross the gray vertical.

```{r fig.width=7, fig.height=3}
# from R/tracking_reset_pause.R
plotPostPauseTrajectories()
```

Except perhaps for one trial in participant 9, it doesn't look like there are any resets to be seen in the trajectories.

